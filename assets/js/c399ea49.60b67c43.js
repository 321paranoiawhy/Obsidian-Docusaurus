"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4555],{3905:(e,a,t)=>{t.d(a,{Zo:()=>d,kt:()=>g});var n=t(7294);function l(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function r(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?i(Object(t),!0).forEach((function(a){l(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function o(e,a){if(null==e)return{};var t,n,l=function(e,a){if(null==e)return{};var t,n,l={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],a.indexOf(t)>=0||(l[t]=e[t]);return l}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var p=n.createContext({}),m=function(e){var a=n.useContext(p),t=a;return e&&(t="function"==typeof e?e(a):r(r({},a),e)),t},d=function(e){var a=m(e.components);return n.createElement(p.Provider,{value:a},e.children)},s="mdxType",c={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},u=n.forwardRef((function(e,a){var t=e.components,l=e.mdxType,i=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),s=m(t),u=l,g=s["".concat(p,".").concat(u)]||s[u]||c[u]||i;return t?n.createElement(g,r(r({ref:a},d),{},{components:t})):n.createElement(g,r({ref:a},d))}));function g(e,a){var t=arguments,l=a&&a.mdxType;if("string"==typeof e||l){var i=t.length,r=new Array(i);r[0]=u;var o={};for(var p in a)hasOwnProperty.call(a,p)&&(o[p]=a[p]);o.originalType=e,o[s]="string"==typeof e?e:l,r[1]=o;for(var m=2;m<i;m++)r[m]=t[m];return n.createElement.apply(null,r)}return n.createElement.apply(null,t)}u.displayName="MDXCreateElement"},6879:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>p,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>o,toc:()=>m});var n=t(7462),l=(t(7294),t(3905));const i={},r="\u61d2\u52a0\u8f7d\u5e93",o={unversionedId:"CSS/Snippets/Lazy-Loading",id:"CSS/Snippets/Lazy-Loading",title:"\u61d2\u52a0\u8f7d\u5e93",description:"- lazysizes",source:"@site/docs/CSS/Snippets/Lazy-Loading.md",sourceDirName:"CSS/Snippets",slug:"/CSS/Snippets/Lazy-Loading",permalink:"/Obsidian-Docusaurus/docs/CSS/Snippets/Lazy-Loading",draft:!1,editUrl:"https://github.com/321paranoiawhy/Obsidian-Docusaurus/edit/dev/docs/CSS/Snippets/Lazy-Loading.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u5355\u4e2a\u6298\u53e0",permalink:"/Obsidian-Docusaurus/docs/CSS/Snippets/Collapse"},next:{title:"Loading",permalink:"/Obsidian-Docusaurus/docs/CSS/Snippets/Loading"}},p={},m=[{value:"\u68c0\u6d4b\u6d4f\u89c8\u5668\u662f\u5426\u652f\u6301 loading \u5c5e\u6027",id:"\u68c0\u6d4b\u6d4f\u89c8\u5668\u662f\u5426\u652f\u6301-loading-\u5c5e\u6027",level:2},{value:"\u4e00\u4e9b\u652f\u6301 loading \u5c5e\u6027\u7684 HTML \u6807\u7b7e",id:"\u4e00\u4e9b\u652f\u6301-loading-\u5c5e\u6027\u7684-html-\u6807\u7b7e",level:2},{value:"\u68c0\u6d4b\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210",id:"\u68c0\u6d4b\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210",level:2},{value:"\u8ba1\u7b97\u56fe\u7247\u52a0\u8f7d\u8017\u65f6",id:"\u8ba1\u7b97\u56fe\u7247\u52a0\u8f7d\u8017\u65f6",level:2},{value:"\u68c0\u6d4b\u56fe\u7247\u662f\u5426\u6709\u7f13\u5b58",id:"\u68c0\u6d4b\u56fe\u7247\u662f\u5426\u6709\u7f13\u5b58",level:2},{value:"\u56fe\u7247\u94fe\u63a5\u5931\u6548",id:"\u56fe\u7247\u94fe\u63a5\u5931\u6548",level:2},{value:"Reference",id:"reference",level:2},{value:"Reference",id:"reference-1",level:2},{value:"\u5d4c\u5165\u5de5\u5177",id:"\u5d4c\u5165\u5de5\u5177",level:2},{value:"\u68c0\u6d4b iframe \u52a0\u8f7d\u5b8c\u6210",id:"\u68c0\u6d4b-iframe-\u52a0\u8f7d\u5b8c\u6210",level:2},{value:"\u901a\u4fe1",id:"\u901a\u4fe1",level:2}],d={toc:m},s="wrapper";function c(e){let{components:a,...t}=e;return(0,l.kt)(s,(0,n.Z)({},d,t,{components:a,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"\u61d2\u52a0\u8f7d\u5e93"},"\u61d2\u52a0\u8f7d\u5e93"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/aFarkas/lazysizes"},"lazysizes")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://afarkas.github.io/lazysizes/#examples"},"lazysizes demo")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/verlok/vanilla-lazyload"},"vanilla lazyload")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/ApoorvSaxena/lozad.js"},"lozad.js")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/twobin/react-lazyload"},"react-lazyload")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/malchata/yall.js"},"yall.js"))),(0,l.kt)("h1",{id:"image"},"image"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'<img src="https://unsplash.dogedoge.com/photos/UAGqBTkMeA4" loading="lazy" />\n<iframe src="https://www.google.com/" loading="lazy"></iframe>\n')),(0,l.kt)("admonition",{type:"tip"},(0,l.kt)("mdxAdmonitionTitle",{parentName:"admonition"},(0,l.kt)("inlineCode",{parentName:"mdxAdmonitionTitle"},"loading")," \u5c5e\u6027\u679a\u4e3e\u503c"),(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"lazy")," : \u61d2\u52a0\u8f7d"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"eager")," : \u7acb\u5373\u52a0\u8f7d"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"auto")," : \u4ea4\u7531\u6d4f\u89c8\u5668\u81ea\u884c\u51b3\u5b9a"))),(0,l.kt)("h2",{id:"\u68c0\u6d4b\u6d4f\u89c8\u5668\u662f\u5426\u652f\u6301-loading-\u5c5e\u6027"},"\u68c0\u6d4b\u6d4f\u89c8\u5668\u662f\u5426\u652f\u6301 loading \u5c5e\u6027"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u4e09\u79cd\u65b9\u5f0f\u7686\u53ef\u68c0\u6d4b\u6d4f\u89c8\u5668\u662f\u5426\u652f\u6301 ",(0,l.kt)("inlineCode",{parentName:"p"},"loading")," \u5c5e\u6027:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const isLoadingSupported = "loading" in HTMLImageElement.prototype;\n// const isLoadingSupported = "loading" in document.createElement("img");\n// const isLoadingSupported = "loading" in new Iamge();\n')),(0,l.kt)("p",null,"\u5bf9\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"},"iframe")," \u6807\u7b7e:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const isLoadingSupported = "loading" in HTMLIFrameElement.prototype;\n// const isLoadingSupported = "loading" in document.createElement("iframe");\n')),(0,l.kt)("admonition",{type:"caution"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://caniuse.com/loading-lazy-attr"},"FireFox")," \u4e0d\u652f\u6301 ",(0,l.kt)("inlineCode",{parentName:"li"},"iframe")," \u6807\u7b7e\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"loading")," \u5c5e\u6027\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#browser_compatibility"},"iframe browser compatibility - MDN")))),(0,l.kt)("h2",{id:"\u4e00\u4e9b\u652f\u6301-loading-\u5c5e\u6027\u7684-html-\u6807\u7b7e"},"\u4e00\u4e9b\u652f\u6301 loading \u5c5e\u6027\u7684 HTML \u6807\u7b7e"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"img")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"iframe"))),(0,l.kt)("h2",{id:"\u68c0\u6d4b\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210"},"\u68c0\u6d4b\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210"),(0,l.kt)("p",null,"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"image")," \u5143\u7d20\u7684 ",(0,l.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/complete"},"compelete \u5c5e\u6027"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const image = document.querySelector("img");\nconst imageLoadingDone = image.complete;\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'Object.getOwnPropertyDescriptor(document.querySelector("img").__proto__, "complete");\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"img")," \u52a0\u8f7d\u5b8c\u6210\u7684\u56de\u8c03\u4e8b\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"onload")," :"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const image = document.querySelector("img");\nimage.onload = () => {};\n')),(0,l.kt)("h2",{id:"\u8ba1\u7b97\u56fe\u7247\u52a0\u8f7d\u8017\u65f6"},"\u8ba1\u7b97\u56fe\u7247\u52a0\u8f7d\u8017\u65f6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const loadImage = (url) =>\n  new Promise((resolve, reject) => {\n    let image = new Image();\n    image.onload = () => {\n      resolve(url);\n      console.timeEnd("\u56fe\u7247\u52a0\u8f7d\u8017\u65f6: ");\n      image = undefined;\n    };\n    image.onerror = () => reject(url);\n    image.src = url;\n  });\n\nconsole.time("\u56fe\u7247\u52a0\u8f7d\u8017\u65f6: ");\n\nloadImage("https://images.pexels.com/photos/1684880/pexels-photo-1684880.jpeg");\n')),(0,l.kt)("h2",{id:"\u68c0\u6d4b\u56fe\u7247\u662f\u5426\u6709\u7f13\u5b58"},"\u68c0\u6d4b\u56fe\u7247\u662f\u5426\u6709\u7f13\u5b58"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const image = document.querySelector("img");\nconst imageHasCache = image.naturalWidth || image.naturalHeight;\n')),(0,l.kt)("h2",{id:"\u56fe\u7247\u94fe\u63a5\u5931\u6548"},"\u56fe\u7247\u94fe\u63a5\u5931\u6548"),(0,l.kt)("p",null,"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"image")," \u5143\u7d20\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"onerror")," \u4e8b\u4ef6:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const image = document.querySelector("img");\nimage.onerror = () => {};\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.zhangxinxu.com/wordpress/2020/10/css-style-image-load-fail/"},"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25\u540eCSS\u6837\u5f0f\u5904\u7406\u6700\u4f73\u5b9e\u8df5"))),(0,l.kt)("h2",{id:"reference"},"Reference"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://web.dev/lazy-loading/"},"Use lazy loading to improve loading speed")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://web.dev/browser-level-image-lazy-loading/"},"Browser-level image lazy loading for the web")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/Performance/Lazy_loading"},"Lazy loading - MDN")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://imagekit.io/blog/lazy-loading-images-complete-guide/"},"Lazy Loading Images \u2013 The Complete Guide")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://addyosmani.com/blog/lazy-loading/"},"Native image lazy-loading for the web!")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://web.dev/iframe-lazy-loading/#can-i-lazy-load-iframes-cross-browser-yes"},"It's time to lazy-load offscreen iframes!")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://web.dev/fast/#lazy-load-images-and-video"},"Lazy-load images and video")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://web.dev/lazy-loading-images/"},"Lazy loading images")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://web.dev/lazy-loading-video/"},"Lazy loading video"))),(0,l.kt)("h1",{id:"video"},"video"),(0,l.kt)("p",null,"\u8bbe\u7f6e ",(0,l.kt)("inlineCode",{parentName:"p"},"video")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"preload")," \u5c5e\u6027\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"none")," :"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- disable preloading --\x3e\n<video controls preload="none" width="300">\n  <source\n    src="https://file-examples.com/storage/fe0b804ac5640668798b8d0/2017/04/file_example_MP4_480_1_5MG.mp4"\n    type="video/mp4"\n  />\n</video>\n')),(0,l.kt)("admonition",{type:"caution"},(0,l.kt)("p",{parentName:"admonition"},"\u987b\u786e\u4fdd\u672a\u8bbe\u7f6e ",(0,l.kt)("inlineCode",{parentName:"p"},"autoplay")," \u5c5e\u6027, \u5426\u5219 ",(0,l.kt)("inlineCode",{parentName:"p"},"preload")," \u5c5e\u6027\u65e0\u6548\u3002")),(0,l.kt)("p",null,"\u8bbe\u7f6e ",(0,l.kt)("inlineCode",{parentName:"p"},"video")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"poster")," \u5c5e\u6027\u5360\u4f4d, \u907f\u514d\u6d4f\u89c8\u5668\u95f4\u6837\u5f0f\u5dee\u5f02:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'<video controls preload="none" poster="img/cover.jpg" width="300">\n  <source src="https://file-examples.com/storage/fe0b804ac5640668798b8d0/2017/04/file_example_MP4_480_1_5MG.mp4" type="video/mp4" />\n</video>\n')),(0,l.kt)("h2",{id:"reference-1"},"Reference"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://usefulangle.com/post/287/html-video-lazy-load"},"https://usefulangle.com/post/287/html-video-lazy-load"))),(0,l.kt)("h1",{id:"iframe"},"iframe"),(0,l.kt)("h2",{id:"\u5d4c\u5165\u5de5\u5177"},"\u5d4c\u5165\u5de5\u5177"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/paulirish/lite-youtube-embed"},"Lite YouTube Embed"))),(0,l.kt)("h2",{id:"\u68c0\u6d4b-iframe-\u52a0\u8f7d\u5b8c\u6210"},"\u68c0\u6d4b iframe \u52a0\u8f7d\u5b8c\u6210"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const iframe = document.createElement("iframe");\niframe.src = "http://sc.jb51.net";\n\n// IE\nif (iframe.attachEvent) {\n  iframe.attachEvent("onload", () => {\n    console.log("Local iframe is now loaded.");\n  });\n  // not IE\n} else {\n  iframe.onload = () => {\n    console.log("Local iframe is now loaded.");\n  };\n}\n')),(0,l.kt)("h2",{id:"\u901a\u4fe1"},"\u901a\u4fe1"),(0,l.kt)("p",null,"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"postMessage")," :"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'// iframe\nconst iframe = document.querySelector("iframe");\niframe.contentWindow.postMessage("message from iframe", "*");\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'// \u7236\u9875\u9762\nwindow.addEventListener(\n  "message",\n  (e) => {\n    console.log(e.data, "\u63a5\u6536\u7684\u6570\u636e");\n  },\n  false\n);\n')))}c.isMDXComponent=!0}}]);